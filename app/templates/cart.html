{% extends "base.html" %}

{% block content %}
<div class="container mx-auto mt-10">
    <h1 class="text-3xl font-bold text-center mb-6">üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h1>

    {% if cart_items %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for item in cart_items %}
            <div class="p-4 border rounded-lg shadow-md bg-white">
                <img src="{{ url_for('static', path='images/' + item.product_id|string + '.webp') }}" alt="–§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞" class="w-full h-40 object-cover">
                <h2 class="text-xl font-semibold mt-2">{{ item.name }}</h2>
                <p class="text-gray-600">{{ item.description }}</p>
                <p class="text-lg font-bold mt-2">{{ item.price }} ‚ÇΩ x {{ item.quantity }}</p>
                <p class="text-lg font-bold text-red-500">–í—Å–µ–≥–æ: {{ item.total_cost }} ‚ÇΩ</p>
                <button onclick="removeFromCart({{ item.product_id }})" class="mt-3 bg-red-500 text-white px-4 py-2 rounded-lg">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
            {% endfor %}
        </div>

        <div class="text-center mt-6">
            <button onclick="checkout()" class="bg-green-500 text-white px-6 py-3 rounded-lg text-lg">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
    {% else %}
        <p class="text-center text-lg text-gray-600">–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ üõí</p>
    {% endif %}
</div>

<script>
    async function removeFromCart(productId) {
        await fetch(`/cart/remove/${productId}`, { method: 'DELETE' });
        location.reload(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
    }

    async function checkout() {
        await fetch("/cart/checkout", { method: "POST" });
        alert("–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!");
        window.location.href = "/pages/products";
    }
</script>
{% endblock %}